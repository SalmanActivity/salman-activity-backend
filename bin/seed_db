var mongoose = require('mongoose')
var passwordHash = require('password-hash')
var debug = require('debug')('seed')
var config = require('../config')
var user = require('../user/user')

let userDocuments = [
  {
    'username': 'test',
    'password': passwordHash.generate('test'),
    'name': 'Test User',
    'roles':[]
  }
]

mongoose.connect(config.mongoConnection).then(resp => {
  debug('connected to mongo server')
}).then(() => {
  debug('inserting users documents')
  return user.insertMany(userDocuments, {upsert: true})
}).then(() => {
  debug('success seeding database')
  mongoose.disconnect()
  process.exit()
}).catch(error => {
  debug('error occured', error)
  process.exit()
})